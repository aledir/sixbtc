# ==============================================================================
# SIXBTC MASTER CONFIGURATION
# ==============================================================================
# Last updated: 2025-12-20
# Version: 1.0.0
#
# IMPORTANT: All values in this file are REQUIRED - no fallback defaults!
# Missing or invalid config will cause system to crash at startup (Fast Fail)
# Sensitive credentials (API keys, passwords) go in .env, NOT here

system:
  name: "SixBTC"
  version: "1.0.0"
  execution_mode: hybrid  # sync, async, multiprocess, hybrid

# ==============================================================================
# GLOBAL TIMEFRAMES (used by downloader, generator, backtester, executor)
# ==============================================================================
timeframes: ['15m', '30m', '1h', '4h', '1d']

# ==============================================================================
# DIRECTORIES
# ==============================================================================
directories:
  strategies: strategies
  data: data

# ==============================================================================
# DATABASE (PostgreSQL via Docker)
# ==============================================================================
database:
  # Connection settings (from .env)
  host: ${DB_HOST}
  port: ${DB_PORT}
  database: ${DB_NAME}
  user: ${DB_USER}
  password: ${DB_PASSWORD}

  pool:
    min_connections: 5
    max_connections: 50
    pool_recycle: 3600

# ==============================================================================
# HYPERLIQUID EXCHANGE
# ==============================================================================
hyperliquid:
  private_key: ${HL_PRIVATE_KEY}
  vault_address: ${HL_VAULT_ADDRESS}

  # Fees for backtesting (taker fee = market orders)
  fee_rate: 0.00045  # 0.045% taker fee
  slippage: 0.0005   # 0.05% estimated slippage

  websocket:
    ping_interval: 30
    ping_timeout: 10

  subaccounts:
    total: 10
    test_mode:
      enabled: false
      count: 3
      capital_per_account: 100

# ==============================================================================
# RISK MANAGEMENT
# ==============================================================================
risk:
  sizing_mode: atr  # 'fixed' or 'atr'

  fixed_fractional:
    risk_per_trade_pct: 0.02
    max_position_size_pct: 0.20

  atr:
    period: 14
    stop_multiplier: 2.0
    take_profit_multiplier: 3.0
    min_risk_reward: 1.5
    volatility_scaling:
      enabled: true
      low_volatility_threshold: 0.015
      high_volatility_threshold: 0.05
      scaling_factor: 0.5

  limits:
    max_open_positions_per_subaccount: 4

  emergency:
    max_portfolio_drawdown: 0.30
    max_daily_loss: 0.10
    max_subaccount_drawdown: 0.25
    max_consecutive_losses: 5

# ==============================================================================
# AI CONFIGURATION
# ==============================================================================
ai:
  mode: cli  # "cli" or "api"
  cli:
    model: claude
    timeout: 300
  api:
    model: claude-sonnet-4-20250514
    timeout: 120

# ==============================================================================
# GENERATION (AI Templates + Parametric Variations)
# ==============================================================================
generation:
  templates_per_day: 20        # AI templates to generate per day
  min_interval_seconds: 0      # Min seconds between AI calls
  parallel_threads: 1
  # NOTE: Each template generates ~100 parametric variations (no AI cost)
  # So 20 templates/day = ~2000 strategies/day
  # Leverage is read from DB (coins.max_leverage), not configured here

# ==============================================================================
# PATTERN DISCOVERY (External API)
# ==============================================================================
pattern_discovery:
  api_url: http://localhost:8001
  tier_filter: 1               # Only use Tier 1 validated patterns
  min_quality_score: 0.75      # Minimum pattern quality score

# ==============================================================================
# VALIDATION (Strategy Code Validation)
# ==============================================================================
validation:
  parallel_threads: 5

# ==============================================================================
# BACKTESTING
# ==============================================================================
backtesting:
  lookback_days: 180
  initial_capital: 10000
  parallel_threads: 10

  # Multi-pair backtesting
  backtest_pairs_count: 100  # Top N pairs by volume from database

  # Dual-period backtesting (full + recent)
  recent_period_days: 60     # Recent period for "in-form" validation
  full_period_weight: 0.60   # Weight for full period score
  recent_period_weight: 0.40 # Weight for recent period score

  thresholds:
    min_sharpe: 1.0
    min_win_rate: 0.55
    min_total_trades: 100
    min_expectancy: 0.02
    max_drawdown: 0.30

# ==============================================================================
# CLASSIFICATION & SELECTION
# ==============================================================================
classification:
  frequency_hours: 1
  score_weights:
    edge: 0.40
    sharpe: 0.30
    consistency: 0.20
    stability: 0.10
  diversification:
    max_same_type: 3
    max_same_timeframe: 5

# ==============================================================================
# DEPLOYMENT & ROTATION
# ==============================================================================
deployment:
  rotation_frequency_hours: 24
  shutdown:
    close_positions: false
    cancel_orders: true

# ==============================================================================
# SUBACCOUNT MANAGER
# ==============================================================================
subaccount_manager:
  dry_run: true
  rotation_interval_hours: 24
  rebalance_enabled: true

# ==============================================================================
# MONITORING
# ==============================================================================
monitoring:
  snapshot_interval_minutes: 15
  check_interval_seconds: 30

# ==============================================================================
# LOGGING
# ==============================================================================
logging:
  level: INFO
  file: logs/sixbtc.log
  max_bytes: 10485760
  backup_count: 5
  modules:
    orchestrator: INFO
    executor: INFO
    backtester: INFO
    generator: INFO
    data_provider: WARNING

# ==============================================================================
# DATA SCHEDULER
# ==============================================================================
data_scheduler:
  enabled: true
  update_hours: [4, 16]
  top_pairs_count: 200
  min_volume_usd: 0
  download_days: null

